# CannaSignal Cron Orchestrator Worker
# Triggers every 15 minutes to scrape all embedded Dutchie locations
# 
# FULLSCRAPE UPDATE (2026-02-20):
# - 18 total locations, ~10 active after deduplication
# - URL deduplication reduces browser sessions
# - Disabled broken Just Breathe URLs (404)

name = "cannasignal-cron"
main = "index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# 15-minute cron schedule
[triggers]
crons = ["*/15 * * * *"]

# Extend CPU limit for safety buffer (default 30s, max 5min for paid)
# Most time is I/O wait, but retries can consume CPU
[limits]
cpu_ms = 60000  # 60 seconds (2x default)

# Secrets (set via `wrangler secret put`)
# BROWSERBASE_API_KEY
# BROWSERBASE_PROJECT_ID  
# DISCORD_WEBHOOK_URL

[vars]
CONVEX_URL = "https://quick-weasel-225.convex.site"
BROWSERBASE_PROJECT_ID = "5838b775-9417-42f0-b272-c0142eec43b7"
